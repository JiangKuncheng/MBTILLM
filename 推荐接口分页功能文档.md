 # MBTIæ¨èç³»ç»Ÿ - æ¨èæ¥å£åˆ†é¡µåŠŸèƒ½æ–‡æ¡£

## ğŸ“‹ æ¦‚è¿°

æœ¬ç³»ç»Ÿæä¾›äº†ä¸¤ä¸ªä¸»è¦çš„æ¨èæ¥å£ï¼Œæ”¯æŒåˆ†é¡µæµè§ˆå’Œå†…å®¹è¯¦æƒ…è·å–ï¼Œè®©å‰ç«¯å¯ä»¥çµæ´»åœ°å±•ç¤ºæ¨èå†…å®¹ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚

## ğŸš€ æ¥å£åˆ—è¡¨

### 1. ç”¨æˆ·ä¸ªæ€§åŒ–æ¨èæ¥å£
**æ¥å£åœ°å€ï¼š** `GET /api/v1/recommendations/{user_id}`

**åŠŸèƒ½æè¿°ï¼š** æ ¹æ®ç”¨æˆ·çš„MBTIç‰¹å¾ï¼Œæ¨èç›¸ä¼¼åº¦æœ€é«˜çš„å†…å®¹

### 2. ç›¸ä¼¼å†…å®¹æ¨èæ¥å£  
**æ¥å£åœ°å€ï¼š** `GET /api/v1/recommendations/similar/{content_id}`

**åŠŸèƒ½æè¿°ï¼š** æ ¹æ®æŒ‡å®šå†…å®¹çš„MBTIç‰¹å¾ï¼Œæ¨èç›¸ä¼¼åº¦æœ€é«˜çš„å…¶ä»–å†…å®¹

---

## ğŸ“– æ¥å£è¯¦ç»†è¯´æ˜

### ç”¨æˆ·ä¸ªæ€§åŒ–æ¨èæ¥å£

#### è¯·æ±‚å‚æ•°

| å‚æ•°å | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|--------|------|
| `user_id` | int | âœ… | - | ç”¨æˆ·IDï¼ˆè·¯å¾„å‚æ•°ï¼‰ |
| `page` | int | âŒ | 1 | é¡µç ï¼Œä»1å¼€å§‹ |
| `limit` | int | âŒ | 20 | æ¯é¡µæ•°é‡ï¼Œ1-100 |
| `content_type` | string | âŒ | all | å†…å®¹ç±»å‹ï¼šarticle/video/product/all |
| `similarity_threshold` | float | âŒ | 0.5 | ç›¸ä¼¼åº¦é˜ˆå€¼ï¼Œ0.1-0.9 |
| `exclude_viewed` | boolean | âŒ | true | æ˜¯å¦æ’é™¤å·²æµè§ˆå†…å®¹ |
| `fresh_days` | int | âŒ | 30 | å†…å®¹æ–°é²œåº¦å¤©æ•° |
| `include_content_details` | boolean | âŒ | true | æ˜¯å¦åŒ…å«å†…å®¹è¯¦æƒ… |

#### è¯·æ±‚ç¤ºä¾‹

```bash
# è·å–ç”¨æˆ·1çš„ç¬¬ä¸€é¡µæ¨èï¼Œæ¯é¡µ10æ¡
GET /api/v1/recommendations/1?page=1&limit=10&include_content_details=true

# è·å–ç”¨æˆ·1çš„ç¬¬äºŒé¡µæ¨èï¼Œæ’é™¤å·²æµè§ˆå†…å®¹
GET /api/v1/recommendations/1?page=2&limit=20&exclude_viewed=true

# è·å–ç”¨æˆ·1çš„è§†é¢‘æ¨è
GET /api/v1/recommendations/1?content_type=video&page=1&limit=15
```

#### å“åº”æ ¼å¼

```json
{
  "success": true,
  "data": {
    "recommendations": [
      {
        "content_id": 12345,
        "title": "æ–‡ç« æ ‡é¢˜",
        "similarity_score": 0.85,
        "mbti_vector": [0.8, 0.6, 0.7, 0.9],
        "content": {
          "id": 12345,
          "title": "æ–‡ç« æ ‡é¢˜",
          "content": "æ–‡ç« å†…å®¹...",
          "author": "ä½œè€…å",
          "publish_time": "2024-01-01T10:00:00Z",
          "tags": ["æ ‡ç­¾1", "æ ‡ç­¾2"]
        }
      }
    ],
    "user_mbti": {
      "type": "INTJ",
      "vector": [0.8, 0.6, 0.7, 0.9]
    },
    "similarity_stats": {
      "average": 0.75,
      "maximum": 0.85,
      "minimum": 0.65
    },
    "metadata": {
      "total_candidates": 150,
      "valid_candidates": 120,
      "scored_contents": 100,
      "recommendation_count": 20,
      "scoring_pending": 5
    },
    "pagination": {
      "current_page": 1,
      "total_pages": 6,
      "total_count": 100,
      "limit": 20,
      "offset": 0,
      "has_next": true,
      "has_prev": false
    }
  },
  "message": "æ¨èç”ŸæˆæˆåŠŸ"
}
```

#### åˆ†é¡µä¿¡æ¯è¯´æ˜

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `current_page` | int | å½“å‰é¡µç  |
| `total_pages` | int | æ€»é¡µæ•° |
| `total_count` | int | æ€»æ¨èæ•°é‡ |
| `limit` | int | æ¯é¡µæ•°é‡ |
| `offset` | int | åç§»é‡ï¼ˆå†…éƒ¨ä½¿ç”¨ï¼‰ |
| `has_next` | boolean | æ˜¯å¦æœ‰ä¸‹ä¸€é¡µ |
| `has_prev` | boolean | æ˜¯å¦æœ‰ä¸Šä¸€é¡µ |

---

### ç›¸ä¼¼å†…å®¹æ¨èæ¥å£

#### è¯·æ±‚å‚æ•°

| å‚æ•°å | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|--------|------|
| `content_id` | int | âœ… | - | åŸºç¡€å†…å®¹IDï¼ˆè·¯å¾„å‚æ•°ï¼‰ |
| `page` | int | âŒ | 1 | é¡µç ï¼Œä»1å¼€å§‹ |
| `limit` | int | âŒ | 20 | æ¯é¡µæ•°é‡ï¼Œ1-100 |
| `user_id` | int | âŒ | - | ç”¨æˆ·IDï¼ˆå¯é€‰ï¼Œç”¨äºä¸ªæ€§åŒ–ï¼‰ |
| `include_content_details` | boolean | âŒ | true | æ˜¯å¦åŒ…å«å†…å®¹è¯¦æƒ… |

#### è¯·æ±‚ç¤ºä¾‹

```bash
# è·å–å†…å®¹12345çš„ç›¸ä¼¼æ¨èï¼Œç¬¬ä¸€é¡µ
GET /api/v1/recommendations/similar/12345?page=1&limit=10&include_content_details=true

# è·å–å†…å®¹12345çš„ç›¸ä¼¼æ¨èï¼Œç¬¬äºŒé¡µ
GET /api/v1/recommendations/similar/12345?page=2&limit=15
```

#### å“åº”æ ¼å¼

```json
{
  "success": true,
  "data": {
    "base_content_id": 12345,
    "base_mbti_vector": [0.8, 0.6, 0.7, 0.9],
    "similar_contents": [
      {
        "content_id": 67890,
        "similarity_score": 0.82,
        "mbti_distance": 0.18,
        "rank": 1,
        "content": {
          "id": 67890,
          "title": "ç›¸ä¼¼æ–‡ç« æ ‡é¢˜",
          "content": "ç›¸ä¼¼æ–‡ç« å†…å®¹...",
          "author": "ä½œè€…å",
          "publish_time": "2024-01-01T10:00:00Z"
        }
      }
    ],
    "pagination": {
      "current_page": 1,
      "total_pages": 3,
      "total_count": 45,
      "limit": 20,
      "offset": 0,
      "has_next": true,
      "has_prev": false
    }
  }
}
```

---

## ğŸ”§ å‰ç«¯é›†æˆæŒ‡å—

### åˆ†é¡µå¯¼èˆªç»„ä»¶

```javascript
// åˆ†é¡µç»„ä»¶ç¤ºä¾‹
function Pagination({ pagination, onPageChange }) {
  const { current_page, total_pages, has_next, has_prev } = pagination;
  
  return (
    <div className="pagination">
      <button 
        disabled={!has_prev} 
        onClick={() => onPageChange(current_page - 1)}
      >
        ä¸Šä¸€é¡µ
      </button>
      
      <span>ç¬¬ {current_page} é¡µï¼Œå…± {total_pages} é¡µ</span>
      
      <button 
        disabled={!has_next} 
        onClick={() => onPageChange(current_page + 1)}
      >
        ä¸‹ä¸€é¡µ
      </button>
    </div>
  );
}
```

### æ¨èåˆ—è¡¨ç»„ä»¶

```javascript
// æ¨èåˆ—è¡¨ç»„ä»¶ç¤ºä¾‹
function RecommendationList({ recommendations, pagination, onPageChange }) {
  return (
    <div className="recommendation-list">
      {/* æ¨èå†…å®¹åˆ—è¡¨ */}
      {recommendations.map(item => (
        <div key={item.content_id} className="recommendation-item">
          <h3>{item.title}</h3>
          <p>ç›¸ä¼¼åº¦: {item.similarity_score}</p>
          
          {/* å¦‚æœåŒ…å«å†…å®¹è¯¦æƒ… */}
          {item.content && (
            <div className="content-details">
              <p>{item.content.content.substring(0, 100)}...</p>
              <p>ä½œè€…: {item.content.author}</p>
              <p>å‘å¸ƒæ—¶é—´: {item.content.publish_time}</p>
            </div>
          )}
        </div>
      ))}
      
      {/* åˆ†é¡µç»„ä»¶ */}
      <Pagination pagination={pagination} onPageChange={onPageChange} />
    </div>
  );
}
```

### APIè°ƒç”¨ç¤ºä¾‹

```javascript
// è·å–ç”¨æˆ·æ¨è
async function getUserRecommendations(userId, page = 1, limit = 20) {
  try {
    const response = await fetch(
      `/api/v1/recommendations/${userId}?page=${page}&limit=${limit}&include_content_details=true`
    );
    
    if (!response.ok) {
      throw new Error('è·å–æ¨èå¤±è´¥');
    }
    
    const data = await response.json();
    return data.data;
  } catch (error) {
    console.error('è·å–æ¨èå¤±è´¥:', error);
    throw error;
  }
}

// è·å–ç›¸ä¼¼å†…å®¹æ¨è
async function getSimilarRecommendations(contentId, page = 1, limit = 20) {
  try {
    const response = await fetch(
      `/api/v1/recommendations/similar/${contentId}?page=${page}&limit=${limit}&include_content_details=true`
    );
    
    if (!response.ok) {
      throw new Error('è·å–ç›¸ä¼¼æ¨èå¤±è´¥');
    }
    
    const data = await response.json();
    return data.data;
  } catch (error) {
    console.error('è·å–ç›¸ä¼¼æ¨èå¤±è´¥:', error);
    throw error;
  }
}
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. åˆ†é¡µç­–ç•¥
- **åˆç†è®¾ç½®æ¯é¡µæ•°é‡**ï¼šå»ºè®®20-50æ¡ï¼Œé¿å…å•æ¬¡è¯·æ±‚æ•°æ®è¿‡å¤š
- **é¢„åŠ è½½ä¸‹ä¸€é¡µ**ï¼šå¯ä»¥åœ¨ç”¨æˆ·æµè§ˆå½“å‰é¡µæ—¶ï¼Œé¢„åŠ è½½ä¸‹ä¸€é¡µæ•°æ®
- **ç¼“å­˜ç­–ç•¥**ï¼šå¯¹çƒ­é—¨ç”¨æˆ·çš„æ¨èç»“æœè¿›è¡Œç¼“å­˜

### 2. å†…å®¹è¯¦æƒ…æ§åˆ¶
- **æŒ‰éœ€åŠ è½½**ï¼š`include_content_details=false` æ—¶åªè¿”å›åŸºç¡€ä¿¡æ¯ï¼Œå‡å°‘ä¼ è¾“é‡
- **æ‡’åŠ è½½**ï¼šç”¨æˆ·ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…æ—¶å†åŠ è½½å®Œæ•´å†…å®¹
- **å›¾ç‰‡ä¼˜åŒ–**ï¼šå†…å®¹ä¸­çš„å›¾ç‰‡ä½¿ç”¨æ‡’åŠ è½½å’Œå‹ç¼©

### 3. é”™è¯¯å¤„ç†
- **ç½‘ç»œå¼‚å¸¸**ï¼šå®ç°é‡è¯•æœºåˆ¶å’Œé™çº§ç­–ç•¥
- **æ•°æ®ç¼ºå¤±**ï¼šå½“å†…å®¹è¯¦æƒ…è·å–å¤±è´¥æ—¶ï¼Œæ˜¾ç¤ºåŸºç¡€ä¿¡æ¯
- **ç”¨æˆ·å‹å¥½**ï¼šæä¾›æ¸…æ™°çš„é”™è¯¯æç¤ºå’ŒåŠ è½½çŠ¶æ€

---

## ğŸ” è°ƒè¯•å’Œæµ‹è¯•

### æµ‹è¯•ç”¨ä¾‹

```bash
# 1. åŸºç¡€åŠŸèƒ½æµ‹è¯•
curl "http://localhost:8000/api/v1/recommendations/1?page=1&limit=5"

# 2. åˆ†é¡µåŠŸèƒ½æµ‹è¯•
curl "http://localhost:8000/api/v1/recommendations/1?page=2&limit=5"

# 3. å†…å®¹è¯¦æƒ…æµ‹è¯•
curl "http://localhost:8000/api/v1/recommendations/1?include_content_details=true"

# 4. ç›¸ä¼¼æ¨èæµ‹è¯•
curl "http://localhost:8000/api/v1/recommendations/similar/10001?page=1&limit=10"
```

### å¸¸è§é—®é¢˜æ’æŸ¥

| é—®é¢˜ | å¯èƒ½åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|----------|----------|
| åˆ†é¡µä¸å‡†ç¡® | æ•°æ®åœ¨è¯·æ±‚è¿‡ç¨‹ä¸­å‘ç”Ÿå˜åŒ– | ä½¿ç”¨æ—¶é—´æˆ³æˆ–ç‰ˆæœ¬å·ç¡®ä¿æ•°æ®ä¸€è‡´æ€§ |
| å†…å®¹è¯¦æƒ…ä¸ºç©º | Sohu APIè°ƒç”¨å¤±è´¥ | æ£€æŸ¥ç½‘ç»œè¿æ¥å’ŒAPIé…ç½® |
| æ¨èæ•°é‡ä¸è¶³ | ç”¨æˆ·MBTIç‰¹å¾æœªå»ºç«‹ | å¼•å¯¼ç”¨æˆ·å®ŒæˆMBTIæµ‹è¯• |
| å“åº”æ—¶é—´è¿‡é•¿ | æ•°æ®åº“æŸ¥è¯¢å¤æ‚ | ä¼˜åŒ–æŸ¥è¯¢è¯­å¥ï¼Œæ·»åŠ ç´¢å¼• |

---





---



---

*æœ€åæ›´æ–°æ—¶é—´ï¼š2024å¹´1æœˆ*